[2025-03-24 02:19:48] [DEBUG] Query: SELECT * FROM users WHERE id = ?
Params: ["4"]
[2025-03-24 02:19:48] [DEBUG] Query: SELECT u.*, 
                         (SELECT COUNT(*) FROM orders WHERE customer_id = u.id) as order_count,
                         (SELECT SUM(total_amount) FROM orders WHERE customer_id = u.id) as total_spent,
                         (SELECT MAX(created_at) FROM orders WHERE customer_id = u.id) as last_order_date
                         FROM users u
                         WHERE u.id = ?
Params: ["4"]
[2025-03-24 02:19:48] [DEBUG] Query: SELECT o.*, 
                       (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as items_count
                       FROM orders o
                       WHERE o.customer_id = ?
                       ORDER BY o.created_at DESC
                       LIMIT 5
Params: ["4"]
[2025-03-24 02:19:48] [DEBUG] Query: SELECT DISTINCT p.id, p.name, p.image, p.price, pc.name as category_name
                FROM products p
                JOIN product_categories pc ON p.category_id = pc.id
                WHERE p.category_id IN (
                    SELECT DISTINCT p2.category_id
                    FROM orders o
                    JOIN order_items oi ON o.id = oi.order_id
                    JOIN products p2 ON oi.product_id = p2.id
                    WHERE o.customer_id = ?
                )
                AND p.id NOT IN (
                    SELECT oi.product_id
                    FROM orders o
                    JOIN order_items oi ON o.id = oi.order_id
                    WHERE o.customer_id = ?
                )
                AND p.status = 'active'
                LIMIT ?
Params: ["4","4",4]
[2025-03-24 02:19:48] [DEBUG] Query: SELECT DISTINCT p.id, p.name, p.image, p.price, pc.name as category_name
                          FROM products p
                          JOIN product_categories pc ON p.category_id = pc.id
                          LEFT JOIN order_items oi ON p.id = oi.product_id
                          WHERE p.status = 'active'
                          AND (p.id NOT IN ())
                          GROUP BY p.id, p.name, p.image, p.price, pc.name
                          ORDER BY COUNT(oi.id) DESC
                          LIMIT ?
Params: [4]
[2025-03-24 02:19:48] [DEBUG] Query: SELECT m.*, u.name as sender_name, u.role as sender_role
                         FROM messages m
                         JOIN users u ON m.sender_id = u.id
                         WHERE m.receiver_id = ? AND m.is_read = 0
                         ORDER BY m.created_at DESC
Params: ["4"]
[2025-03-24 02:20:13] [DEBUG] Query: SELECT * FROM users WHERE id = ?
Params: ["4"]
[2025-03-24 02:20:13] [DEBUG] Query: SELECT o.*, 
                 (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as items_count
                 FROM orders o
                 WHERE o.customer_id = ?
                 ORDER BY o.created_at DESC
Params: ["4"]
[2025-03-24 02:20:38] [DEBUG] Query: SELECT * FROM users WHERE id = ?
Params: ["4"]
[2025-03-24 02:20:38] [DEBUG] Query: SELECT u.*, 
                         (SELECT COUNT(*) FROM orders WHERE customer_id = u.id) as order_count,
                         (SELECT SUM(total_amount) FROM orders WHERE customer_id = u.id) as total_spent,
                         (SELECT MAX(created_at) FROM orders WHERE customer_id = u.id) as last_order_date
                         FROM users u
                         WHERE u.id = ?
Params: ["4"]
[2025-03-24 02:20:38] [DEBUG] Query: SELECT o.*, 
                       (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as items_count
                       FROM orders o
                       WHERE o.customer_id = ?
                       ORDER BY o.created_at DESC
                       LIMIT 5
Params: ["4"]
[2025-03-24 02:20:38] [DEBUG] Query: SELECT DISTINCT p.id, p.name, p.image, p.price, pc.name as category_name
                FROM products p
                JOIN product_categories pc ON p.category_id = pc.id
                WHERE p.category_id IN (
                    SELECT DISTINCT p2.category_id
                    FROM orders o
                    JOIN order_items oi ON o.id = oi.order_id
                    JOIN products p2 ON oi.product_id = p2.id
                    WHERE o.customer_id = ?
                )
                AND p.id NOT IN (
                    SELECT oi.product_id
                    FROM orders o
                    JOIN order_items oi ON o.id = oi.order_id
                    WHERE o.customer_id = ?
                )
                AND p.status = 'active'
                LIMIT ?
Params: ["4","4",4]
[2025-03-24 02:20:38] [DEBUG] Query: SELECT DISTINCT p.id, p.name, p.image, p.price, pc.name as category_name
                          FROM products p
                          JOIN product_categories pc ON p.category_id = pc.id
                          LEFT JOIN order_items oi ON p.id = oi.product_id
                          WHERE p.status = 'active'
                          AND (p.id NOT IN ())
                          GROUP BY p.id, p.name, p.image, p.price, pc.name
                          ORDER BY COUNT(oi.id) DESC
                          LIMIT ?
Params: [4]
[2025-03-24 02:20:38] [DEBUG] Query: SELECT m.*, u.name as sender_name, u.role as sender_role
                         FROM messages m
                         JOIN users u ON m.sender_id = u.id
                         WHERE m.receiver_id = ? AND m.is_read = 0
                         ORDER BY m.created_at DESC
Params: ["4"]
[2025-03-24 02:21:11] [DEBUG] Query: SELECT * FROM users WHERE id = ?
Params: ["4"]
[2025-03-24 02:21:11] [DEBUG] Query: SELECT u.*, 
                         (SELECT COUNT(*) FROM orders WHERE customer_id = u.id) as order_count,
                         (SELECT SUM(total_amount) FROM orders WHERE customer_id = u.id) as total_spent,
                         (SELECT MAX(created_at) FROM orders WHERE customer_id = u.id) as last_order_date
                         FROM users u
                         WHERE u.id = ?
Params: ["4"]
[2025-03-24 02:21:11] [DEBUG] Query: SELECT o.*, 
                       (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as items_count
                       FROM orders o
                       WHERE o.customer_id = ?
                       ORDER BY o.created_at DESC
                       LIMIT 5
Params: ["4"]
[2025-03-24 02:21:11] [DEBUG] Query: SELECT DISTINCT p.id, p.name, p.image, p.price, pc.name as category_name
                FROM products p
                JOIN product_categories pc ON p.category_id = pc.id
                WHERE p.category_id IN (
                    SELECT DISTINCT p2.category_id
                    FROM orders o
                    JOIN order_items oi ON o.id = oi.order_id
                    JOIN products p2 ON oi.product_id = p2.id
                    WHERE o.customer_id = ?
                )
                AND p.id NOT IN (
                    SELECT oi.product_id
                    FROM orders o
                    JOIN order_items oi ON o.id = oi.order_id
                    WHERE o.customer_id = ?
                )
                AND p.status = 'active'
                LIMIT ?
Params: ["4","4",4]
[2025-03-24 02:21:11] [DEBUG] Query: SELECT DISTINCT p.id, p.name, p.image, p.price, pc.name as category_name
                          FROM products p
                          JOIN product_categories pc ON p.category_id = pc.id
                          LEFT JOIN order_items oi ON p.id = oi.product_id
                          WHERE p.status = 'active'
                          AND (p.id NOT IN ())
                          GROUP BY p.id, p.name, p.image, p.price, pc.name
                          ORDER BY COUNT(oi.id) DESC
                          LIMIT ?
Params: [4]
[2025-03-24 02:21:11] [DEBUG] Query: SELECT m.*, u.name as sender_name, u.role as sender_role
                         FROM messages m
                         JOIN users u ON m.sender_id = u.id
                         WHERE m.receiver_id = ? AND m.is_read = 0
                         ORDER BY m.created_at DESC
Params: ["4"]
[2025-03-24 02:21:16] [DEBUG] Query: SELECT * FROM users WHERE id = ?
Params: ["4"]
[2025-03-24 02:21:16] [DEBUG] Query: SELECT u.*, 
                         (SELECT COUNT(*) FROM orders WHERE customer_id = u.id) as order_count,
                         (SELECT SUM(total_amount) FROM orders WHERE customer_id = u.id) as total_spent,
                         (SELECT MAX(created_at) FROM orders WHERE customer_id = u.id) as last_order_date
                         FROM users u
                         WHERE u.id = ?
Params: ["4"]
[2025-03-24 02:21:16] [DEBUG] Query: SELECT o.*, 
                       (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as items_count
                       FROM orders o
                       WHERE o.customer_id = ?
                       ORDER BY o.created_at DESC
                       LIMIT 5
Params: ["4"]
[2025-03-24 02:21:16] [DEBUG] Query: SELECT DISTINCT p.id, p.name, p.image, p.price, pc.name as category_name
                FROM products p
                JOIN product_categories pc ON p.category_id = pc.id
                WHERE p.category_id IN (
                    SELECT DISTINCT p2.category_id
                    FROM orders o
                    JOIN order_items oi ON o.id = oi.order_id
                    JOIN products p2 ON oi.product_id = p2.id
                    WHERE o.customer_id = ?
                )
                AND p.id NOT IN (
                    SELECT oi.product_id
                    FROM orders o
                    JOIN order_items oi ON o.id = oi.order_id
                    WHERE o.customer_id = ?
                )
                AND p.status = 'active'
                LIMIT ?
Params: ["4","4",4]
[2025-03-24 02:21:16] [DEBUG] Query: SELECT DISTINCT p.id, p.name, p.image, p.price, pc.name as category_name
                          FROM products p
                          JOIN product_categories pc ON p.category_id = pc.id
                          LEFT JOIN order_items oi ON p.id = oi.product_id
                          WHERE p.status = 'active'
                          AND (p.id NOT IN ())
                          GROUP BY p.id, p.name, p.image, p.price, pc.name
                          ORDER BY COUNT(oi.id) DESC
                          LIMIT ?
Params: [4]
[2025-03-24 02:21:16] [DEBUG] Query: SELECT m.*, u.name as sender_name, u.role as sender_role
                         FROM messages m
                         JOIN users u ON m.sender_id = u.id
                         WHERE m.receiver_id = ? AND m.is_read = 0
                         ORDER BY m.created_at DESC
Params: ["4"]
[2025-03-24 02:21:33] [DEBUG] Query: SELECT * FROM users WHERE id = ?
Params: ["4"]
[2025-03-24 02:21:33] [DEBUG] Query: SELECT u.*, 
                         (SELECT COUNT(*) FROM orders WHERE customer_id = u.id) as order_count,
                         (SELECT SUM(total_amount) FROM orders WHERE customer_id = u.id) as total_spent,
                         (SELECT MAX(created_at) FROM orders WHERE customer_id = u.id) as last_order_date
                         FROM users u
                         WHERE u.id = ?
Params: ["4"]
[2025-03-24 02:21:33] [DEBUG] Query: SELECT o.*, 
                       (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as items_count
                       FROM orders o
                       WHERE o.customer_id = ?
                       ORDER BY o.created_at DESC
                       LIMIT 5
Params: ["4"]
[2025-03-24 02:21:33] [DEBUG] Query: SELECT DISTINCT p.id, p.name, p.image, p.price, pc.name as category_name
                FROM products p
                JOIN product_categories pc ON p.category_id = pc.id
                WHERE p.category_id IN (
                    SELECT DISTINCT p2.category_id
                    FROM orders o
                    JOIN order_items oi ON o.id = oi.order_id
                    JOIN products p2 ON oi.product_id = p2.id
                    WHERE o.customer_id = ?
                )
                AND p.id NOT IN (
                    SELECT oi.product_id
                    FROM orders o
                    JOIN order_items oi ON o.id = oi.order_id
                    WHERE o.customer_id = ?
                )
                AND p.status = 'active'
                LIMIT ?
Params: ["4","4",4]
[2025-03-24 02:21:33] [DEBUG] Query: SELECT DISTINCT p.id, p.name, p.image, p.price, pc.name as category_name
                          FROM products p
                          JOIN product_categories pc ON p.category_id = pc.id
                          LEFT JOIN order_items oi ON p.id = oi.product_id
                          WHERE p.status = 'active'
                          AND (p.id NOT IN ())
                          GROUP BY p.id, p.name, p.image, p.price, pc.name
                          ORDER BY COUNT(oi.id) DESC
                          LIMIT ?
Params: [4]
[2025-03-24 02:21:33] [DEBUG] Query: SELECT m.*, u.name as sender_name, u.role as sender_role
                         FROM messages m
                         JOIN users u ON m.sender_id = u.id
                         WHERE m.receiver_id = ? AND m.is_read = 0
                         ORDER BY m.created_at DESC
Params: ["4"]
[2025-03-24 02:22:19] [DEBUG] Query: SELECT * FROM users WHERE id = ?
Params: ["4"]
[2025-03-24 02:22:19] [DEBUG] Query: SELECT u.*, 
                         (SELECT COUNT(*) FROM orders WHERE customer_id = u.id) as order_count,
                         (SELECT SUM(total_amount) FROM orders WHERE customer_id = u.id) as total_spent,
                         (SELECT MAX(created_at) FROM orders WHERE customer_id = u.id) as last_order_date
                         FROM users u
                         WHERE u.id = ?
Params: ["4"]
[2025-03-24 02:22:19] [DEBUG] Query: SELECT o.*, 
                       (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as items_count
                       FROM orders o
                       WHERE o.customer_id = ?
                       ORDER BY o.created_at DESC
                       LIMIT 5
Params: ["4"]
[2025-03-24 02:22:19] [DEBUG] Query: SELECT DISTINCT p.id, p.name, p.image, p.price, pc.name as category_name
                FROM products p
                JOIN product_categories pc ON p.category_id = pc.id
                WHERE p.category_id IN (
                    SELECT DISTINCT p2.category_id
                    FROM orders o
                    JOIN order_items oi ON o.id = oi.order_id
                    JOIN products p2 ON oi.product_id = p2.id
                    WHERE o.customer_id = ?
                )
                AND p.id NOT IN (
                    SELECT oi.product_id
                    FROM orders o
                    JOIN order_items oi ON o.id = oi.order_id
                    WHERE o.customer_id = ?
                )
                AND p.status = 'active'
                LIMIT ?
Params: ["4","4",4]
[2025-03-24 02:22:19] [DEBUG] Query: SELECT DISTINCT p.id, p.name, p.image, p.price, pc.name as category_name
                          FROM products p
                          JOIN product_categories pc ON p.category_id = pc.id
                          LEFT JOIN order_items oi ON p.id = oi.product_id
                          WHERE p.status = 'active'
                          AND (p.id NOT IN ())
                          GROUP BY p.id, p.name, p.image, p.price, pc.name
                          ORDER BY COUNT(oi.id) DESC
                          LIMIT ?
Params: [4]
[2025-03-24 02:22:19] [DEBUG] Query: SELECT m.*, u.name as sender_name, u.role as sender_role
                         FROM messages m
                         JOIN users u ON m.sender_id = u.id
                         WHERE m.receiver_id = ? AND m.is_read = 0
                         ORDER BY m.created_at DESC
Params: ["4"]
[2025-03-24 02:22:20] [DEBUG] Query: SELECT * FROM users WHERE id = ?
Params: ["4"]
[2025-03-24 02:22:20] [DEBUG] Query: SELECT ci.*, p.name, p.image, p.price, p.stock_quantity
                FROM cart_items ci
                JOIN products p ON ci.product_id = p.id
                WHERE ci.session_id = ?
Params: ["user_4"]
[2025-03-24 02:22:20] [DEBUG] Query: SELECT * FROM promotions 
                 WHERE status = 'active' 
                 AND (NOW() BETWEEN start_date AND end_date)
                 ORDER BY min_order_amount DESC
Params: []
